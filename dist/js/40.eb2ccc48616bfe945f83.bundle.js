"use strict";(self.webpackChunktracker=self.webpackChunktracker||[]).push([[40],{2866:function(t,e,n){n.d(e,{n:function(){return c}});var r=n(2284),a=(n(2675),n(9463),n(2010),n(6099),n(3362),n(2505)),s=n.n(a),i=n(14),o=n(1347),u=s().create({baseURL:"https://time.skillum.ru",headers:{"Content-type":"application/x-www-form-urlencoded"}});u.interceptors.response.use((function(t){return"object"===(0,r.A)(t.data)&&null!==t.data&&"token"in t.data&&(localStorage.setItem("token",t.data.token),delete t.data.token),t}),(function(t){return void 0!==t.response&&"status"in t.response&&401===t.response.status&&(0,i.W5)()&&((0,i.ri)(),location.reload()),Promise.reject(t)})),u.interceptors.request.use((function(t){return t.headers.token=(0,i.gf)(),t}));var c={auth:function(t,e,n){var r={login:t,password:e,action:n};return u.post("/api/auth",(0,o.u4)(r))},getTasks:function(t,e){var n=(0,o.Yq)(t),r=new Date(e.getTime());r.setDate(e.getDate()+1);var a="/api/tasks?interval="+n+"-"+(0,o.Yq)(r);return u.get(a)},getGroupedTasks:function(t,e){var n="/api/grouped_tasks?interval="+(0,o.Yq)(t)+"-"+(0,o.Yq)(e);return u.get(n)},getCurrentTask:function(){return u.get("/api/current")},getCompletitions:function(t){return t?u.get("/api/completitions?text="+t):u.get("/api/completitions")},getTrackers:function(){return u.get("/api/trackers")},getProjects:function(t){return u.get("/api/projects",{params:{projects:t}})},getUserProjects:function(){return u.get("/api/user_projects")},getUserTags:function(){return u.get("/api/user_tags")},getTrackerProjects:function(t){return u.get("/api/trackerProjects",{params:{id:t}})},getEvoUsers:function(){return u.get("/api/evoUsers")},addTask:function(t){return u.post("/api/task",(0,o.u4)({name:t}))},getToken:function(t,e,n){return u.post("/api/getToken",(0,o.u4)({id:t,login:e,password:n}))},getSettings:function(){return u.get("/api/settings")},saveSettings:function(t){return u.post("/api/settings",(0,o.u4)(t))},stopTask:function(t){return u.post("/api/task/stop",(0,o.u4)({id:t}))},resumeTask:function(t){return u.post("/api/task/resume",(0,o.u4)({id:t}))},updateTask:function(t){return u.post("/api/task/edit",(0,o.u4)({id:t.id,name:t.name,category:t.category,date:t.date,start_time:t.start_time,end_time:t.end_time,description:t.description,tags:t.tags}))},deleteTask:function(t){return u.post("/api/task/delete",(0,o.u4)({id:t}))},saveTracker:function(t){return u.post("/api/tracker",(0,o.u4)({id:t.id,title:t.title,type:t.type,api_url:t.api_url}))},linkProject:function(t,e,n){return u.post("/api/linkProject",(0,o.u4)({projectId:t,trackerId:e,trackerProjectId:null!==n?n.value:0,trackerProjectTitle:null!==n?n.label:0}))},saveEvoUser:function(t){return u.post("/api/evoUser",(0,o.u4)({id:t.value}))},deleteTracker:function(t){return u.post("/api/tracker/delete",(0,o.u4)({id:t.id}))},getTrackerTask:function(t,e){return u.get("/api/trackerTask",{params:{trackerId:t,taskId:e}})},getVersion:function(t){return u.get("/api/version?version="+t)},exportTask:function(t){return u.post("/api/task/export",(0,o.u4)(t))}};e.A=c},14:function(t,e,n){function r(){var t=localStorage.getItem("token");return null!==t&&""!==t}function a(){localStorage.removeItem("token")}function s(){return localStorage.getItem("token")}n.d(e,{W5:function(){return r},gf:function(){return s},ri:function(){return a}})},1347:function(t,e,n){function r(t){return Object.keys(t).reduce((function(e,n){return e.push(n+"="+encodeURIComponent(t[n])),e}),[]).join("&")}function a(t,e){if(null===t||""===t)return[];var n=[],r=t.split(" "),a=" ";return r.forEach((function(t,s){if(a.length>0){var i=a+" "+t;if(!(i.length>e))return s===r.length-1?void n.push(i):void(a=i);n.push(a),a=""}s!==r.length-1&&t.length<e?a=t:n.push(t)})),n}function s(t,e){return("0"+t.getDate()).slice(-2)+"."+("0"+(t.getMonth()+1)).slice(-2)+(void 0===e?"."+t.getFullYear():"")}function i(t){var e=Math.floor(t),n=Math.floor(60*(t-e));return n<10&&(n="0"+n),e+":"+n}n.d(e,{Yq:function(){return s},ad:function(){return i},u4:function(){return r},wR:function(){return a}}),n(8598),n(4782),n(9432),n(6099),n(3500)},7432:function(t,e,n){var r=n(4991),a=n.n(r),s=n(6314),i=n.n(s)()(a());i.push([t.id,"","",{version:3,sources:[],names:[],mappings:"",sourceRoot:""}]),e.A=i},7304:function(t,e,n){n.r(e),n.d(e,{default:function(){return c}}),n(2675),n(9463),n(2010);var r=function(){var t=this,e=t._self._c;return e("md-list-item",[t.edit?e("div",{staticClass:"task-col task-edit",on:{click:function(e){return t.$emit("edit",t.task)}}},[e("md-tooltip",{attrs:{"md-direction":"top"}},[t._v("Редактировать")]),t._v(" "),e("font-awesome-icon",{attrs:{icon:"edit"}})],1):t._e(),t._v(" "),t.edit&&t.task.end_time?e("div",{staticClass:"task-col task-resume",on:{click:function(e){return t.$emit("resume",t.task)}}},[e("font-awesome-icon",{attrs:{icon:"play-circle"}}),t._v(" "),e("md-tooltip",{attrs:{"md-direction":"top"}},[t._v("Продолжить")])],1):t._e(),t._v(" "),t.edit&&!t.task.end_time?e("div",{staticClass:"task-col task-stop",on:{click:function(e){return t.$emit("stop",t.task)}}},[e("font-awesome-icon",{attrs:{icon:"stop-circle"}}),t._v(" "),e("md-tooltip",{attrs:{"md-direction":"top"}},[t._v("Остановить")])],1):t._e(),t._v(" "),t.task.start_time?e("div",{staticClass:"task-col task-start-time"},[t._v(t._s(t.task.start_time)+" ")]):t._e(),t._v(" "),t.task.end_time?e("div",{staticClass:"task-col task-end-time"},[t._v(t._s(t.task.end_time)+" ")]):t._e(),t._v(" "),e("div",{staticClass:"task-col task-name"},[t._v(t._s(t.task.name))]),t._v(" "),t.task.category?e("md-badge",{staticClass:"task-col task-category md-primary md-square",attrs:{"md-content":t.task.category}}):t._e(),t._v(" "),e("div",{staticClass:"task-col task-tags"},[t._l(t.task.tags,(function(t){return[e("md-badge",{key:t,staticClass:"md-square",attrs:{"md-content":t}})]}))],2),t._v(" "),e("div",{staticClass:"task-col task-description"},[t._v(t._s(t.task.description))]),t._v(" "),e("div",{staticClass:"task-col task-duration"},[t._v(t._s(t.deltaTime))])],1)};r._withStripped=!0;var a=n(1347),s={computed:{deltaTime:function(){return(0,a.ad)(this.task.delta)}},props:{task:{type:Object,required:!0},edit:!1}},i=n(5072),o=n.n(i),u=n(7432),c=(o()(u.A,{insert:"head",singleton:!1}),u.A.locals,(0,n(4486).A)(s,r,[],!1,null,null,null).exports)},3040:function(t,e,n){n.r(e),n.d(e,{default:function(){return u}});var r=function(){var t=this,e=t._self._c;return null!==t.current?e("div",[e("form",{staticClass:"md-layout md-gutter md-alignment-top-center center",attrs:{action:"",method:"post"},on:{submit:function(e){return e.preventDefault(),t.stopTask()}}},[e("md-card",{staticClass:"md-layout-item md-large-size-50 md-xlarge-size-50 md-medium-size-70 md-small-size-100"},[e("md-card-content",[e("div",{staticClass:"md-layout"},[e("md-list",{staticClass:"md-layout-item md-size-80"},[e("TaskItem",{attrs:{task:t.current}})],1),t._v(" "),e("div",{staticClass:"md-layout-item md-size-20"},[e("md-button",{staticClass:"md-primary",staticStyle:{"margin-top":"12px"},attrs:{type:"submit"}},[t._v("остановить")])],1)],1)])],1)],1)]):t._e()};r._withStripped=!0;var a=n(7304),s=n(2866),i=n(1347),o={data:function(){return{current:null}},computed:{title:function(){return null===this.currentTask?"Time Tracker":(0,i.ad)(this.current.delta)+" "+this.current.activity}},methods:{getCurrentTask:function(){var t=this;s.A.getCurrentTask().then((function(e){"status"in e.data&&e.data.status||!("status"in e.data)?(t.current=e.data,document.title=t.title):(t.current=null,document.title="Time tracker")})).catch((function(t){console.log(["getCurrentTask error",t])}))},stopTask:function(){var t=this;s.A.stopTask(this.current.id).then((function(e){t.$emit("stop-task"),t.current=null})).catch((function(t){console.log(["getCompletitions error",t])}))}},components:{TaskItem:a.default},mounted:function(){this.getCurrentTask()}},u=(0,n(4486).A)(o,r,[],!1,null,null,null).exports}}]);