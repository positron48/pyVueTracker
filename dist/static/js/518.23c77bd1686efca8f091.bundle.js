(self.webpackChunktracker=self.webpackChunktracker||[]).push([[518],{2866:function(t,e,s){"use strict";s.d(e,{n:function(){return u}});var a=s(2284),i=(s(2675),s(9463),s(2010),s(6099),s(3362),s(2505)),n=s.n(i),r=s(14),o=s(1347),c=n().create({baseURL:"https://time.retailcrm.tech",headers:{"Content-type":"application/x-www-form-urlencoded"}});c.interceptors.response.use((function(t){return"object"===(0,a.A)(t.data)&&null!==t.data&&"token"in t.data&&(localStorage.setItem("token",t.data.token),delete t.data.token),t}),(function(t){return void 0!==t.response&&"status"in t.response&&401===t.response.status&&(0,r.W5)()&&((0,r.ri)(),location.reload()),Promise.reject(t)})),c.interceptors.request.use((function(t){return t.headers.token=(0,r.gf)(),t}));var u={auth:function(t,e,s){var a={login:t,password:e,action:s};return c.post("/api/auth",(0,o.u4)(a))},getTasks:function(t,e){var s=(0,o.Yq)(t),a=new Date(e.getTime());a.setDate(e.getDate()+1);var i="/api/tasks?interval="+s+"-"+(0,o.Yq)(a);return c.get(i)},getGroupedTasks:function(t,e){var s="/api/grouped_tasks?interval="+(0,o.Yq)(t)+"-"+(0,o.Yq)(e);return c.get(s)},getCurrentTask:function(){return c.get("/api/current")},getCompletitions:function(t){return t?c.get("/api/completitions?text="+t):c.get("/api/completitions")},getTrackers:function(){return c.get("/api/trackers")},getProjects:function(t){return c.get("/api/projects",{params:{projects:t}})},getUserProjects:function(){return c.get("/api/user_projects")},getUserTags:function(){return c.get("/api/user_tags")},getTrackerProjects:function(t){return c.get("/api/trackerProjects",{params:{id:t}})},getEvoUsers:function(){return c.get("/api/evoUsers")},addTask:function(t){return c.post("/api/task",(0,o.u4)({name:t}))},getToken:function(t,e,s){return c.post("/api/getToken",(0,o.u4)({id:t,login:e,password:s}))},getSettings:function(){return c.get("/api/settings")},saveSettings:function(t){return c.post("/api/settings",(0,o.u4)(t))},stopTask:function(t){return c.post("/api/task/stop",(0,o.u4)({id:t}))},resumeTask:function(t){return c.post("/api/task/resume",(0,o.u4)({id:t}))},updateTask:function(t){return c.post("/api/task/edit",(0,o.u4)({id:t.id,name:t.name,category:t.category,date:t.date,start_time:t.start_time,end_time:t.end_time,description:t.description,tags:t.tags}))},deleteTask:function(t){return c.post("/api/task/delete",(0,o.u4)({id:t}))},saveTracker:function(t){return c.post("/api/tracker",(0,o.u4)({id:t.id,title:t.title,type:t.type,api_url:t.api_url}))},linkProject:function(t,e,s){return c.post("/api/linkProject",(0,o.u4)({projectId:t,trackerId:e,trackerProjectId:null!==s?s.value:0,trackerProjectTitle:null!==s?s.label:0}))},saveEvoUser:function(t){return c.post("/api/evoUser",(0,o.u4)({id:t.value}))},deleteTracker:function(t){return c.post("/api/tracker/delete",(0,o.u4)({id:t.id}))},getTrackerTask:function(t,e){return c.get("/api/trackerTask",{params:{trackerId:t,taskId:e}})},getVersion:function(t){return c.get("/api/version?version="+t)},exportTask:function(t){return c.post("/api/task/export",(0,o.u4)(t))}};e.A=u},14:function(t,e,s){"use strict";function a(){var t=localStorage.getItem("token");return null!==t&&""!==t}function i(){localStorage.removeItem("token")}function n(){return localStorage.getItem("token")}s.d(e,{W5:function(){return a},gf:function(){return n},ri:function(){return i}})},1347:function(t,e,s){"use strict";function a(t){return Object.keys(t).reduce((function(e,s){return e.push(s+"="+encodeURIComponent(t[s])),e}),[]).join("&")}function i(t,e){if(null===t||""===t)return[];var s=[],a=t.split(" "),i=" ";return a.forEach((function(t,n){if(i.length>0){var r=i+" "+t;if(!(r.length>e))return n===a.length-1?void s.push(r):void(i=r);s.push(i),i=""}n!==a.length-1&&t.length<e?i=t:s.push(t)})),s}function n(t,e){return("0"+t.getDate()).slice(-2)+"."+("0"+(t.getMonth()+1)).slice(-2)+(void 0===e?"."+t.getFullYear():"")}function r(t){var e=Math.floor(t),s=Math.floor(60*(t-e));return s<10&&(s="0"+s),e+":"+s}s.d(e,{Yq:function(){return n},ad:function(){return r},u4:function(){return a},wR:function(){return i}}),s(8598),s(4782),s(9432),s(6099),s(3500)},9011:function(t,e,s){"use strict";var a=s(4991),i=s.n(a),n=s(6314),r=s.n(n)()(i());r.push([t.id,"","",{version:3,sources:[],names:[],mappings:"",sourceRoot:""}]),e.A=r},1037:function(t,e,s){"use strict";var a=s(4991),i=s.n(a),n=s(6314),r=s.n(n)()(i());r.push([t.id,"","",{version:3,sources:[],names:[],mappings:"",sourceRoot:""}]),e.A=r},2738:function(t,e,s){"use strict";var a=s(4991),i=s.n(a),n=s(6314),r=s.n(n)()(i());r.push([t.id,"","",{version:3,sources:[],names:[],mappings:"",sourceRoot:""}]),e.A=r},7432:function(t,e,s){"use strict";var a=s(4991),i=s.n(a),n=s(6314),r=s.n(n)()(i());r.push([t.id,"","",{version:3,sources:[],names:[],mappings:"",sourceRoot:""}]),e.A=r},9823:function(t,e,s){"use strict";var a=s(4991),i=s.n(a),n=s(6314),r=s.n(n)()(i());r.push([t.id,"","",{version:3,sources:[],names:[],mappings:"",sourceRoot:""}]),e.A=r},5358:function(t,e,s){var a={"./af":5177,"./af.js":5177,"./ar":1509,"./ar-dz":1488,"./ar-dz.js":1488,"./ar-kw":8676,"./ar-kw.js":8676,"./ar-ly":2353,"./ar-ly.js":2353,"./ar-ma":4496,"./ar-ma.js":4496,"./ar-ps":6947,"./ar-ps.js":6947,"./ar-sa":2682,"./ar-sa.js":2682,"./ar-tn":9756,"./ar-tn.js":9756,"./ar.js":1509,"./az":5533,"./az.js":5533,"./be":8959,"./be.js":8959,"./bg":7777,"./bg.js":7777,"./bm":4903,"./bm.js":4903,"./bn":1290,"./bn-bd":7357,"./bn-bd.js":7357,"./bn.js":1290,"./bo":1545,"./bo.js":1545,"./br":1470,"./br.js":1470,"./bs":4429,"./bs.js":4429,"./ca":7306,"./ca.js":7306,"./cs":6464,"./cs.js":6464,"./cv":6016,"./cv.js":6016,"./cy":4226,"./cy.js":4226,"./da":3601,"./da.js":3601,"./de":7853,"./de-at":6111,"./de-at.js":6111,"./de-ch":4697,"./de-ch.js":4697,"./de.js":7853,"./dv":708,"./dv.js":708,"./el":4691,"./el.js":4691,"./en-au":3872,"./en-au.js":3872,"./en-ca":8298,"./en-ca.js":8298,"./en-gb":6195,"./en-gb.js":6195,"./en-ie":6584,"./en-ie.js":6584,"./en-il":5543,"./en-il.js":5543,"./en-in":9033,"./en-in.js":9033,"./en-nz":9402,"./en-nz.js":9402,"./en-sg":3004,"./en-sg.js":3004,"./eo":2934,"./eo.js":2934,"./es":7650,"./es-do":838,"./es-do.js":838,"./es-mx":7730,"./es-mx.js":7730,"./es-us":6575,"./es-us.js":6575,"./es.js":7650,"./et":3035,"./et.js":3035,"./eu":3508,"./eu.js":3508,"./fa":119,"./fa.js":119,"./fi":527,"./fi.js":527,"./fil":5995,"./fil.js":5995,"./fo":4858,"./fo.js":4858,"./fr":5498,"./fr-ca":6435,"./fr-ca.js":6435,"./fr-ch":7892,"./fr-ch.js":7892,"./fr.js":5498,"./fy":7071,"./fy.js":7071,"./ga":1734,"./ga.js":1734,"./gd":217,"./gd.js":217,"./gl":7329,"./gl.js":7329,"./gom-deva":2124,"./gom-deva.js":2124,"./gom-latn":3383,"./gom-latn.js":3383,"./gu":5050,"./gu.js":5050,"./he":1713,"./he.js":1713,"./hi":3861,"./hi.js":3861,"./hr":6308,"./hr.js":6308,"./hu":609,"./hu.js":609,"./hy-am":7160,"./hy-am.js":7160,"./id":4063,"./id.js":4063,"./is":9374,"./is.js":9374,"./it":8383,"./it-ch":1827,"./it-ch.js":1827,"./it.js":8383,"./ja":3827,"./ja.js":3827,"./jv":9722,"./jv.js":9722,"./ka":1794,"./ka.js":1794,"./kk":7088,"./kk.js":7088,"./km":6870,"./km.js":6870,"./kn":4451,"./kn.js":4451,"./ko":3164,"./ko.js":3164,"./ku":8174,"./ku-kmr":6181,"./ku-kmr.js":6181,"./ku.js":8174,"./ky":8474,"./ky.js":8474,"./lb":9680,"./lb.js":9680,"./lo":5867,"./lo.js":5867,"./lt":5766,"./lt.js":5766,"./lv":9532,"./lv.js":9532,"./me":8076,"./me.js":8076,"./mi":1848,"./mi.js":1848,"./mk":306,"./mk.js":306,"./ml":3739,"./ml.js":3739,"./mn":9053,"./mn.js":9053,"./mr":6169,"./mr.js":6169,"./ms":3386,"./ms-my":2297,"./ms-my.js":2297,"./ms.js":3386,"./mt":7075,"./mt.js":7075,"./my":2264,"./my.js":2264,"./nb":2274,"./nb.js":2274,"./ne":8235,"./ne.js":8235,"./nl":2572,"./nl-be":3784,"./nl-be.js":3784,"./nl.js":2572,"./nn":4566,"./nn.js":4566,"./oc-lnc":9330,"./oc-lnc.js":9330,"./pa-in":9849,"./pa-in.js":9849,"./pl":4418,"./pl.js":4418,"./pt":9834,"./pt-br":8303,"./pt-br.js":8303,"./pt.js":9834,"./ro":4457,"./ro.js":4457,"./ru":2271,"./ru.js":2271,"./sd":1221,"./sd.js":1221,"./se":3478,"./se.js":3478,"./si":7538,"./si.js":7538,"./sk":5784,"./sk.js":5784,"./sl":6637,"./sl.js":6637,"./sq":6794,"./sq.js":6794,"./sr":5719,"./sr-cyrl":3322,"./sr-cyrl.js":3322,"./sr.js":5719,"./ss":6e3,"./ss.js":6e3,"./sv":1011,"./sv.js":1011,"./sw":748,"./sw.js":748,"./ta":1025,"./ta.js":1025,"./te":1885,"./te.js":1885,"./tet":8861,"./tet.js":8861,"./tg":6571,"./tg.js":6571,"./th":5802,"./th.js":5802,"./tk":9527,"./tk.js":9527,"./tl-ph":9231,"./tl-ph.js":9231,"./tlh":1052,"./tlh.js":1052,"./tr":5096,"./tr.js":5096,"./tzl":9846,"./tzl.js":9846,"./tzm":1765,"./tzm-latn":7711,"./tzm-latn.js":7711,"./tzm.js":1765,"./ug-cn":8414,"./ug-cn.js":8414,"./uk":6618,"./uk.js":6618,"./ur":158,"./ur.js":158,"./uz":7609,"./uz-latn":2475,"./uz-latn.js":2475,"./uz.js":7609,"./vi":1135,"./vi.js":1135,"./x-pseudo":4051,"./x-pseudo.js":4051,"./yo":2218,"./yo.js":2218,"./zh-cn":2648,"./zh-cn.js":2648,"./zh-hk":1632,"./zh-hk.js":1632,"./zh-mo":1541,"./zh-mo.js":1541,"./zh-tw":304,"./zh-tw.js":304};function i(t){var e=n(t);return s(e)}function n(t){if(!s.o(a,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return a[t]}i.keys=function(){return Object.keys(a)},i.resolve=n,t.exports=i,i.id=5358},8123:function(t,e,s){"use strict";s.r(e),s.d(e,{default:function(){return d}});var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"chart"},[e("bar-chart",{attrs:{"chart-data":t.datacollection,options:t.options,height:100}})],1)};a._withStripped=!0;var i=s(4793),n=i.vE.reactiveProp,r={components:{BarChart:{extends:i.yP,mixins:[n],props:["options"],mounted:function(){this.renderChart(this.chartData,this.options)}}},data:function(){return{options:{legend:{display:!1},scales:{yAxes:[{ticks:{beginAtZero:!0}}]}}}},computed:{datacollection:function(){return{labels:this.labels,datasets:[{backgroundColor:"#b2b2b2",data:this.chartData}]}}},props:{chartData:{type:Array},labels:{type:Array}}},o=s(5072),c=s.n(o),u=s(9011),d=(c()(u.A,{insert:"head",singleton:!1}),u.A.locals,(0,s(4486).A)(r,a,[],!1,null,null,null).exports)},2347:function(t,e,s){"use strict";s.r(e),s.d(e,{default:function(){return d}});var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"chart"},[e("horizontal-bar-chart",{attrs:{"chart-data":t.datacollection,options:t.options,height:t.height,styles:t.myStyles}})],1)};a._withStripped=!0,s(2892);var i=s(4793),n=i.vE.reactiveProp,r={components:{HorizontalBarChart:{extends:i.oo,mixins:[n],props:["options"],mounted:function(){this.renderChart(this.chartData,this.options)}}},data:function(){var t=this.labelsWidth;return{options:{legend:{display:!1},scales:{xAxes:[{ticks:{beginAtZero:!0}}],yAxes:[{afterFit:function(e){e.width=t}}]},maintainAspectRatio:!1,barPercentage:.5,title:{display:!0,text:this.titleChart}}}},computed:{datacollection:function(){return{labels:this.labels,datasets:[{backgroundColor:"#b2b2b2",data:this.chartData}]}},height:function(){return 30*this.labels.length+60},myStyles:function(){return{height:"".concat(this.height,"px"),position:"relative"}}},props:{chartData:{type:Array},labels:{type:Array},labelsWidth:{type:Number},titleChart:{type:String}}},o=s(5072),c=s.n(o),u=s(1037),d=(c()(u.A,{insert:"head",singleton:!1}),u.A.locals,(0,s(4486).A)(r,a,[],!1,null,null,null).exports)},7798:function(t,e,s){"use strict";s.r(e),s.d(e,{default:function(){return o}});var a=function(){var t=this,e=t._self._c;return e("transition",{attrs:{name:"modal"}},[e("div",{directives:[{name:"show",rawName:"v-show",value:t.show,expression:"show"}],staticClass:"modal-mask"},[e("div",{staticClass:"modal-container"},[t._t("default")],2)])])};a._withStripped=!0;var i=s(5072),n=s.n(i),r=s(2738),o=(n()(r.A,{insert:"head",singleton:!1}),r.A.locals,(0,s(4486).A)({template:"#new-post-modal-template",props:["show"],data:function(){return{title:"",body:""}},methods:{close:function(){this.$emit("close"),this.title="",this.body=""},savePost:function(){this.close()}}},a,[],!1,null,null,null).exports)},7304:function(t,e,s){"use strict";s.r(e),s.d(e,{default:function(){return u}}),s(2675),s(9463),s(2010);var a=function(){var t=this,e=t._self._c;return e("md-list-item",[t.edit?e("div",{staticClass:"task-col task-edit",on:{click:function(e){return t.$emit("edit",t.task)}}},[e("md-tooltip",{attrs:{"md-direction":"top"}},[t._v("Редактировать")]),t._v(" "),e("font-awesome-icon",{attrs:{icon:"edit"}})],1):t._e(),t._v(" "),t.edit&&t.task.end_time?e("div",{staticClass:"task-col task-resume",on:{click:function(e){return t.$emit("resume",t.task)}}},[e("font-awesome-icon",{attrs:{icon:"play-circle"}}),t._v(" "),e("md-tooltip",{attrs:{"md-direction":"top"}},[t._v("Продолжить")])],1):t._e(),t._v(" "),t.edit&&!t.task.end_time?e("div",{staticClass:"task-col task-stop",on:{click:function(e){return t.$emit("stop",t.task)}}},[e("font-awesome-icon",{attrs:{icon:"stop-circle"}}),t._v(" "),e("md-tooltip",{attrs:{"md-direction":"top"}},[t._v("Остановить")])],1):t._e(),t._v(" "),t.task.start_time?e("div",{staticClass:"task-col task-start-time"},[t._v(t._s(t.task.start_time)+" ")]):t._e(),t._v(" "),t.task.end_time?e("div",{staticClass:"task-col task-end-time"},[t._v(t._s(t.task.end_time)+" ")]):t._e(),t._v(" "),e("div",{staticClass:"task-col task-name"},[t._v(t._s(t.task.name))]),t._v(" "),t.task.category?e("md-badge",{staticClass:"task-col task-category md-primary md-square",attrs:{"md-content":t.task.category}}):t._e(),t._v(" "),e("div",{staticClass:"task-col task-tags"},[t._l(t.task.tags,(function(t){return[e("md-badge",{key:t,staticClass:"md-square",attrs:{"md-content":t}})]}))],2),t._v(" "),e("div",{staticClass:"task-col task-description"},[t._v(t._s(t.task.description))]),t._v(" "),e("div",{staticClass:"task-col task-duration"},[t._v(t._s(t.deltaTime))])],1)};a._withStripped=!0;var i=s(1347),n={computed:{deltaTime:function(){return(0,i.ad)(this.task.delta)}},props:{task:{type:Object,required:!0},edit:!1}},r=s(5072),o=s.n(r),c=s(7432),u=(o()(c.A,{insert:"head",singleton:!1}),c.A.locals,(0,s(4486).A)(n,a,[],!1,null,null,null).exports)},8683:function(t,e,s){"use strict";s.r(e),s.d(e,{default:function(){return k}}),s(2675),s(9463),s(3792),s(6099),s(2953);var a=function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"md-layout md-gutter md-alignment-top-center"},[t.tasks.length?e("div",{staticClass:"md-layout-item md-large-size-50 md-xlarge-size-50 md-medium-size-70 md-small-size-100 taskItems"},[t.chartData.values.length?e("bar-chart",{attrs:{"chart-data":t.chartData.values,labels:t.chartData.labels}}):t._e(),t._v(" "),t._l(t.groupedTasks.dates,(function(s){return[e("md-list",{key:s.date,staticClass:"task-group"},[e("md-list-item",{staticClass:"task-group-date"},[t._v("\n            "+t._s(s.date)+"\n          ")]),t._v(" "),t._l(s.tasks,(function(s){return e("TaskItem",{key:s.id,attrs:{edit:!0,task:s},on:{edit:function(e){return t.editForm(arguments[0])},stop:function(e){return t.stopTask(arguments[0])},resume:function(e){return t.resumeTask(arguments[0])}}})})),t._v(" "),e("md-list-item",{staticClass:"task-duration-list-item"},[t._v("\n            "+t._s(s.duration_formatted)+"\n          ")])],2)]})),t._v(" "),t.chartActivities.values.length?e("horizontal-bar-chart",{attrs:{titleChart:"Задачи","chart-data":t.chartActivities.values,labels:t.chartActivities.labels,labelsWidth:t.labelWidth}}):t._e(),t._v(" "),t.chartCategories.values.length?e("horizontal-bar-chart",{attrs:{titleChart:"Проекты","chart-data":t.chartCategories.values,labels:t.chartCategories.labels,labelsWidth:t.labelWidth}}):t._e(),t._v(" "),t.chartTags.values.length?e("horizontal-bar-chart",{attrs:{titleChart:"Теги","chart-data":t.chartTags.values,labels:t.chartTags.labels,labelsWidth:t.labelWidth}}):t._e()],2):t._e()]),t._v(" "),e("modal",{attrs:{show:t.show},on:{close:t.close}},[e("div",{staticClass:"modal-header"}),t._v(" "),e("div",{staticClass:"modal-body"},[e("div",{staticClass:"md-layout md-gutter"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.editTask.id,expression:"editTask.id"}],attrs:{type:"hidden",name:"id"},domProps:{value:t.editTask.id},on:{input:function(e){e.target.composing||t.$set(t.editTask,"id",e.target.value)}}}),t._v(" "),e("div",{staticClass:"md-layout-item md-size-40"},[e("md-field",{staticClass:"masked-input"},[e("masked-input",{attrs:{mask:"11.11.1111",placeholder:"дата"},model:{value:t.editTask.date,callback:function(e){t.$set(t.editTask,"date",e)},expression:"editTask.date"}})],1)],1),t._v(" "),e("div",{staticClass:"md-layout-item md-size-30"},[e("md-field",{staticClass:"masked-input"},[e("masked-input",{attrs:{mask:"11:11",placeholder:"начало.md-list-item-content"},model:{value:t.editTask.start_time,callback:function(e){t.$set(t.editTask,"start_time",e)},expression:"editTask.start_time"}})],1)],1),t._v(" "),e("div",{staticClass:"md-layout-item md-size-30"},[e("md-field",{staticClass:"masked-input"},[e("masked-input",{attrs:{mask:"11:11",placeholder:"окончание"},model:{value:t.editTask.end_time,callback:function(e){t.$set(t.editTask,"end_time",e)},expression:"editTask.end_time"}})],1)],1)]),t._v(" "),e("md-field",[e("label",[t._v("задача")]),t._v(" "),e("md-input",{model:{value:t.editTaskActivity,callback:function(e){t.editTaskActivity=e},expression:"editTaskActivity"}})],1),t._v(" "),e("md-field",[e("label",[t._v("комментарий")]),t._v(" "),e("md-textarea",{attrs:{"md-autogrow":""},model:{value:t.editTask.description,callback:function(e){t.$set(t.editTask,"description",e)},expression:"editTask.description"}})],1),t._v(" "),e("md-field",[e("label",[t._v("теги")]),t._v(" "),e("md-input",{model:{value:t.editTaskTags,callback:function(e){t.editTaskTags=e},expression:"editTaskTags"}})],1)],1),t._v(" "),e("div",{staticClass:"modal-footer text-right"},[e("md-button",{staticClass:"md-primary",on:{click:function(e){return t.deleteTask()}}},[t._v("удалить")]),t._v(" "),e("md-button",{staticClass:"md-primary",on:{click:function(e){return t.closeModal()}}},[t._v("отмена")]),t._v(" "),e("md-button",{staticClass:"md-accent",on:{click:function(e){return t.saveTask()}}},[t._v("сохранить")])],1)]),t._v(" "),e("md-dialog-alert",{attrs:{"md-active":t.showAlert,"md-content":t.alertMessage,"md-confirm-text":"Ок"},on:{"update:mdActive":function(e){t.showAlert=e},"update:md-active":function(e){t.showAlert=e}}})],1)};a._withStripped=!0,s(8598),s(6910),s(2010),s(9085),s(7495),s(5440),s(3500);var i=s(7304),n=s(8123),r=s(7798),o=s(1347),c=s(2347),u=s(2866),d=s(4855),l={data:function(){return{tasks:[],selectedDate:{start:new Date,end:new Date},showNewPostModal:!1,editTask:{},show:!1,labelWidth:200,showAlert:!1,alertMessage:""}},props:{initialDate:{type:Object}},computed:{groupedTasks:function(){var t={dates:{},activities:{},categories:{},tags:{}};return this.tasks.forEach((function(e,s){void 0===t.dates[e.date]&&(t.dates[e.date]={duration:0,tasks:[],date:e.date}),t.dates[e.date].tasks.push(e),t.dates[e.date].duration+=e.delta,void 0===t.activities[e.activity_id]&&(t.activities[e.activity_id]={duration:0,name:e.name}),t.activities[e.activity_id].duration+=e.delta,void 0===t.categories[e.category]&&(t.categories[e.category]={duration:0,name:e.category}),t.categories[e.category].duration+=e.delta,e.tags.forEach((function(s,a){void 0===t.tags[s]&&(t.tags[s]={duration:0,name:s}),t.tags[s].duration+=e.delta,t.tags[s].duration=Math.round(100*t.tags[s].duration)/100})),t.dates[e.date].duration=Math.round(100*t.dates[e.date].duration)/100,t.activities[e.activity_id].duration=Math.round(100*t.activities[e.activity_id].duration)/100,t.categories[e.category].duration=Math.round(100*t.categories[e.category].duration)/100,t.dates[e.date].duration_formatted=(0,o.ad)(t.dates[e.date].duration),t.activities[e.activity_id].duration_formatted=(0,o.ad)(t.activities[e.activity_id].duration),t.categories[e.category].duration_formatted=(0,o.ad)(t.categories[e.category].duration)})),t},chartData:function(){var t=[],e=[];if(this.selectedDate.start.getTime()!==this.selectedDate.end.getTime())for(var s=new Date(this.selectedDate.start);s<=this.selectedDate.end;){var a=(0,o.Yq)(s);t.push((0,o.Yq)(s,!0)),void 0!==this.groupedTasks.dates[a]?e.push(this.groupedTasks.dates[a].duration):e.push(0),s.setDate(s.getDate()+1)}else for(var i,n,r=this.tasks.length,c=0,u=5,d=0;d<24;d++){for(u=d,t.push(u),e.push(0);c<r&&(i=this.convertToHours(this.tasks[c].start_time),(n=this.convertToHours(this.tasks[c].end_time))<i&&(n+=24),!(i>=u+1));)if(i>=u&&n<=u+1)e[d]+=n-i,c++;else{if(i<=u&&n>=u+1){e[d]+=1;break}if(i>=u&&n>=u+1){e[d]+=u+1-i;break}i<=u&&n<=u+1&&(e[d]+=n-u,c++)}e[d]=Math.round(100*e[d])/100}return{labels:t,values:e}},chartActivities:function(){var t=[],e=[],s=[],a=0,i=this.labelWidth/7;for(var n in this.groupedTasks.activities)s[a]=this.groupedTasks.activities[n],a++;return(s=s.sort((function(t,e){return t.duration===e.duration?0:+(t.duration<e.duration)||-1}))).forEach((function(s,a){t.push((0,o.wR)(s.name,i)),e.push(s.duration)})),{labels:t,values:e}},chartCategories:function(){var t=[],e=[],s=[],a=0,i=this.labelWidth/5;for(var n in this.groupedTasks.categories)s[a]=this.groupedTasks.categories[n],a++;return(s=s.sort((function(t,e){return t.duration===e.duration?0:+(t.duration<e.duration)||-1}))).forEach((function(s,a){t.push((0,o.wR)(s.name,i)),e.push(s.duration)})),{labels:t,values:e}},chartTags:function(){var t=[],e=[],s=[],a=0,i=this.labelWidth/5;for(var n in this.groupedTasks.tags)s[a]=this.groupedTasks.tags[n],a++;return(s=s.sort((function(t,e){return t.duration===e.duration?0:+(t.duration<e.duration)||-1}))).forEach((function(s,a){t.push((0,o.wR)(s.name,i)),e.push(s.duration)})),{labels:t,values:e}},editTaskActivity:{get:function(){if(void 0===this.editTask.name)return"";var t=this.editTask.name;return this.editTask.category&&(t+="@"+this.editTask.category),t},set:function(t){var e=t.split("@",2);this.editTask.name=e[0],void 0!==e[1]?this.editTask.category=e[1]:this.editTask.category=""}},editTaskTags:{get:function(){return void 0===this.editTask.tags?"":this.editTask.tags.join(", ")},set:function(t){var e=t.replace(/,\s*/g,", ").split(", ");this.editTask.tags=e}}},methods:{getTasks:function(){var t=this;u.A.getTasks(this.selectedDate.start,this.selectedDate.end).then((function(e){t.tasks=e.data.tasks})).catch((function(t){console.log(["getTasks error",t])}))},close:function(){this.show=!1},editForm:function(t){this.editTask=Object.assign({},t),this.show=!0},stopTask:function(t){var e=this;u.A.stopTask(t.id).then((function(t){e.$emit("update")})).catch((function(t){console.log(["stopTask error",t])}))},resumeTask:function(t){var e=this;u.A.resumeTask(t.id).then((function(t){e.$emit("update")})).catch((function(t){console.log(["resumeTask error",t])}))},deleteTask:function(){var t=this;confirm("Вы действительно хотите удалить запись?")&&u.A.deleteTask(this.editTask.id).then((function(e){t.$emit("update"),t.closeModal()})).catch((function(t){console.log(["deleteTask error",t])}))},saveTask:function(){var t=this;u.A.updateTask(this.editTask).then((function(e){"message"in e.data&&e.data.message&&t.alert(e.data.message),("status"in e.data&&e.data.status||!("status"in e.data))&&(t.$emit("update"),t.closeModal())})).catch((function(t){console.log(["savePost error",t])}))},closeModal:function(){this.show=!1},convertToHours:function(t){if(t){var e=t.split(":");return parseInt(e[0])+parseInt(e[1])/60}var s=new Date;return s.getHours()+s.getMinutes()/60},refreshDate:function(){this.selectedDate={start:new Date,end:new Date}},alert:function(t){this.alertMessage=t,this.showAlert=!0}},components:{HorizontalBarChart:c.default,TaskItem:i.default,BarChart:n.default,Modal:r.default,MaskedInput:d.A},created:function(){void 0!==this.initialDate&&(this.selectedDate=this.initialDate),this.getTasks()}},h=s(5072),m=s.n(h),p=s(9823),k=(m()(p.A,{insert:"head",singleton:!1}),p.A.locals,(0,s(4486).A)(l,a,[],!1,null,null,null).exports)}}]);